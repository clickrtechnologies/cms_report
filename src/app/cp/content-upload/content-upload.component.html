<form [formGroup]="form" class="container mt-4">
  <ul class="nav nav-tabs" id="uploadTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="single-tab" data-bs-toggle="tab" data-bs-target="#single" type="button"
        role="tab" aria-controls="single" aria-selected="true">
        Single Upload
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="bulk-tab" data-bs-toggle="tab" data-bs-target="#bulk" type="button" role="tab"
        aria-controls="bulk" aria-selected="false">
        Bulk Upload
      </button>
    </li>
  </ul>
  <!-- Tab Content -->
  <div class="tab-content mt-3" id="uploadTabsContent">
    <div class="tab-pane fade show active" id="single" role="tabpanel" aria-labelledby="single-tab">


      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="content-header">Content Upload - CP</h4>


        <button type="button" class="btn btn-info btn-custom" (click)="addContent()">
          <i class="bi bi-plus-circle"></i> Add Content
        </button>
      </div>

      <div class="table-responsive">
        <table class="table table-bordered table-hover text-center align-middle content-upload-table">
          <thead>
            <tr>
              <th>S.No</th>
              <th>Artist Name</th>
              <th>Album Name</th>
              <th>Song Name</th>
              <th>Genre/Cat</th>
              <th>Upload Date</th>
              <th>CP Name</th>
              <th>Country</th>
              <th>MNO</th>
              <th>Audio File</th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody formArrayName="uploads">
            <tr *ngFor="let grp of uploads.controls; let i = index" [formGroupName]="i">
              <td>{{ i + 1 }}</td>

              <!-- Artist -->
              <td>
                <select class="form-control form-control-sm" formControlName="artistId" (change)="onArtistChange(i)">
                  <option value="">-- Select Artist --</option>
                  <option *ngFor="let artist of artistList" [value]="artist.id">
                    {{ artist.artistName }}
                  </option>
                </select>
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="albumName" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="songName" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="genre" />
              </td>

              <td>
                <input type="date" class="form-control form-control-sm" formControlName="uploadDate" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="cpName" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="country" />
              </td>

              <!-- MNO -->
              <td>
                <select class="form-control form-control-sm" formControlName="mnoId" (change)="onMnoChange(i)">
                  <option value="">-- Select MNO --</option>
                  <option *ngFor="let mno of mnoList" [value]="mno.id">
                    {{ mno.name }}
                  </option>
                </select>
              </td>

              <!-- File -->
              <td>
                <div>
                  <input type="file" accept="audio/*" class="form-control form-control-sm"
                    (change)="onFileChange($event, i)" [disabled]="!isEditing[i]" />

                  <audio *ngIf="uploads.at(i).get('audioFileUrl')?.value" [id]="'audio-player-' + i"
                    [src]="uploads.at(i).get('audioFileUrl')?.value">
                  </audio>
                </div>
              </td>

              <td>
                <div class="btn-group btn-group-sm" role="group">
                  <button *ngIf="isEditing[i]" type="button" class="btn btn-success btn-custom"
                    (click)="saveContent(i)">
                    <i class="bi bi-check-circle"></i> Save
                  </button>

                  <button *ngIf="!isEditing[i]" type="button" class="btn btn-primary btn-custom"
                    (click)="editContent(i)">
                    <i class="bi bi-pencil-square"></i> Edit
                  </button>

                  <button type="button" class="btn btn-danger btn-custom" (click)="deleteContent(i)">
                    <i class="bi bi-trash"></i> Delete
                  </button>

                  <button type="button" class="btn btn-secondary btn-custom" (click)="playAudio(i)">
                    <i class="bi bi-play-circle"></i> Play
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Bulk Upload -->
    <div class="tab-pane fade" id="bulk" role="tabpanel" aria-labelledby="bulkUpload-tab">
      <div class="container mt-4" style="max-width: 600px;">
        <div class="card shadow-sm p-4">
          <h5 class="mb-3 text-center">Bulk Song Upload</h5>

          <!-- Download Sample Excel -->
          <div class="mb-3 text-center">
            <a href="assets/sample/songs_bulk_upload.xlsx" download class="btn btn-outline-primary btn-sm">
              Download Sample Excel
            </a>
          </div>

          <!-- Upload Excel -->
          <div class="mb-3">
            <label class="form-label">Song Details (Excel)</label>
            <input type="file" accept=".xlsx, .xls" (change)="onExcelChange($event)"
              class="form-control form-control-sm">
          </div>

          <!-- Upload Multiple Audio Files -->
          <div class="mb-3">
            <label class="form-label">Audio Files</label>
            <input type="file" multiple accept="audio/*" (change)="onAudioFilesChange($event)"
              class="form-control form-control-sm">
            <small class="text-muted d-block mt-1">Select multiple songs at once</small>
          </div>

          <!-- Upload Button -->
          <div class="text-end">
            <button class="btn btn-success btn-sm" (click)="uploadBulk()">Upload All</button>
          </div>
        </div>
      </div>
      <br>


      <div class="table-responsive">
        <table class="table table-bordered table-hover text-center align-middle content-upload-table">
          <thead>
            <tr>
              <th>S.No</th>
              <th>Artist Name</th>
              <th>Album Name</th>
              <th>Song Name</th>
              <th>Genre/Cat</th>
              <th>Upload Date</th>
              <th>CP Name</th>
              <th>Country</th>
              <th>MNO</th>
              <th>Audio File</th>
              <th>Actions</th>
            </tr>
          </thead>

          <tbody formArrayName="uploads">
            <tr *ngFor="let grp of uploads.controls; let i = index" [formGroupName]="i">
              <td>{{ i + 1 }}</td>

              <!-- Artist -->
              <td>
                <select class="form-control form-control-sm" formControlName="artistId" (change)="onArtistChange(i)">
                  <option value="">-- Select Artist --</option>
                  <option *ngFor="let artist of artistList" [value]="artist.id">
                    {{ artist.artistName }}
                  </option>
                </select>
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="albumName" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="songName" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="genre" />
              </td>

              <td>
                <input type="date" class="form-control form-control-sm" formControlName="uploadDate" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="cpName" />
              </td>

              <td>
                <input type="text" class="form-control form-control-sm" formControlName="country" />
              </td>

              <!-- MNO -->
              <td>
                <select class="form-control form-control-sm" formControlName="mnoId" (change)="onMnoChange(i)">
                  <option value="">-- Select MNO --</option>
                  <option *ngFor="let mno of mnoList" [value]="mno.id">
                    {{ mno.name }}
                  </option>
                </select>
              </td>

              <!-- File -->
              <td>
                <div>
                  <input type="file" accept="audio/*" class="form-control form-control-sm"
                    (change)="onFileChange($event, i)" [disabled]="!isEditing[i]" />

                  <audio *ngIf="uploads.at(i).get('audioFileUrl')?.value" [id]="'audio-player-' + i"
                    [src]="uploads.at(i).get('audioFileUrl')?.value">
                  </audio>
                </div>
              </td>

              <td>
                <div class="btn-group btn-group-sm" role="group">
                  <button *ngIf="isEditing[i]" type="button" class="btn btn-success btn-custom"
                    (click)="saveContent(i)">
                    <i class="bi bi-check-circle"></i> Save
                  </button>

                  <button *ngIf="!isEditing[i]" type="button" class="btn btn-primary btn-custom"
                    (click)="editContent(i)">
                    <i class="bi bi-pencil-square"></i> Edit
                  </button>

                  <button type="button" class="btn btn-danger btn-custom" (click)="deleteContent(i)">
                    <i class="bi bi-trash"></i> Delete
                  </button>

                  <button type="button" class="btn btn-secondary btn-custom" (click)="playAudio(i)">
                    <i class="bi bi-play-circle"></i> Play
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>



</form>